<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>被处理内容管理 - 小红书法庭</title>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, 'Helvetica Neue', sans-serif; margin: 0; background: #f6f7f9; }
    header { background: #2f54eb; color: #fff; padding: 16px 24px; }
    .container { max-width: 1200px; margin: 24px auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); }
    h1 { font-size: 24px; margin: 0 0 20px 0; }
    .grid { display: grid; }
    .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
    .md\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
    .gap-6 { gap: 1.5rem; }
    .mb-8 { margin-bottom: 2rem; }
    .bg-white { background-color: white; }
    .rounded-lg { border-radius: 0.5rem; }
    .shadow-md { box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); }
    .p-6 { padding: 1.5rem; }
    .text-2xl { font-size: 1.5rem; }
    .font-bold { font-weight: 700; }
    .text-red-600 { color: #dc2626; }
    .text-orange-600 { color: #ea580c; }
    .text-gray-600 { color: #4b5563; }
    .text-gray-800 { color: #1f2937; }
    .text-xl { font-size: 1.25rem; }
    .font-semibold { font-weight: 600; }
    .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
    .py-4 { padding-top: 1rem; padding-bottom: 1rem; }
    .border-b { border-bottom: 1px solid; }
    .border-gray-200 { border-color: #e5e7eb; }
    .space-y-4 > * + * { margin-top: 1rem; }
    .border { border: 1px solid; }
    .p-4 { padding: 1rem; }
    .flex { display: flex; }
    .justify-between { justify-content: space-between; }
    .items-start { align-items: flex-start; }
    .mb-2 { margin-bottom: 0.5rem; }
    .font-medium { font-weight: 500; }
    .text-gray-500 { color: #6b7280; }
    .text-sm { font-size: 0.875rem; }
    .ml-2 { margin-left: 0.5rem; }
    .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
    .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
    .bg-red-100 { background-color: #fee2e2; }
    .text-red-800 { color: #991b1b; }
    .text-xs { font-size: 0.75rem; }
    .rounded-full { border-radius: 9999px; }
    .text-gray-700 { color: #374151; }
    .bg-red-50 { background-color: #fef2f2; }
    .p-2 { padding: 0.5rem; }
    .bg-orange-100 { background-color: #fff7ed; }
    .text-orange-800 { color: #9a3412; }
    .bg-orange-50 { background-color: #fff7ed; }
    .text-center { text-align: center; }
    .py-8 { padding-top: 2rem; padding-bottom: 2rem; }
    a { color: #2f54eb; text-decoration: none; }
    a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <header>
    <h1>被处理内容管理 - 小红书法庭</h1>
  </header>
  <div class="container">
<div class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold text-gray-800 mb-8">被处理内容管理</h1>
    
    <!-- 统计信息 -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
        <div class="bg-white rounded-lg shadow-md p-6">
            <div class="text-2xl font-bold text-red-600">{{ stats.total_blocked_comments }}</div>
            <div class="text-gray-600">被屏蔽评论</div>
        </div>
        <div class="bg-white rounded-lg shadow-md p-6">
            <div class="text-2xl font-bold text-red-600">{{ stats.total_blocked_evidences }}</div>
            <div class="text-gray-600">被屏蔽证据</div>
        </div>
        <div class="bg-white rounded-lg shadow-md p-6">
            <div class="text-2xl font-bold text-red-600">{{ stats.total_blocked_agreements }}</div>
            <div class="text-gray-600">违规协议</div>
        </div>
        <div class="bg-white rounded-lg shadow-md p-6">
            <div class="text-2xl font-bold text-orange-600">{{ stats.recent_blocks }}</div>
            <div class="text-gray-600">本周新增</div>
        </div>
    </div>
    
    <!-- 被屏蔽的评论 -->
    <div class="bg-white rounded-lg shadow-md mb-8">
        <div class="px-6 py-4 border-b border-gray-200">
            <h2 class="text-xl font-semibold text-gray-800">被屏蔽的评论</h2>
        </div>
        <div class="p-6">
            {% if blocked_comments %}
                <div class="space-y-4">
                    {% for comment in blocked_comments %}
                        <div class="border border-gray-200 rounded-lg p-4">
                            <div class="flex justify-between items-start mb-2">
                                <div>
                                    <span class="font-medium text-gray-800">案件 #{{ comment.case_id }}</span>
                                    <span class="text-gray-500 text-sm ml-2">{{ comment.created_at.strftime('%Y-%m-%d %H:%M') }}</span>
                                </div>
                                <span class="px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full">已屏蔽</span>
                            </div>
                            <div class="text-gray-700 mb-2">
                                <div><strong>原始内容：</strong>{{ comment.content }}</div>
                                {% if comment.processed_content and comment.processed_content != comment.content %}
                                    <div style="margin-top: 8px;"><strong>处理后内容：</strong>{{ comment.processed_content }}</div>
                                {% endif %}
                            </div>
                            {% if comment.violation_reason %}
                                <div class="text-sm text-red-600 bg-red-50 p-2 rounded">
                                    <strong>屏蔽原因：</strong>{{ comment.violation_reason }}
                                </div>
                            {% endif %}
                            {% if comment.processing_info %}
                                <div class="text-sm text-gray-600 bg-gray-50 p-2 rounded" style="margin-top: 8px;">
                                    <strong>处理详情：</strong>
                                    <pre style="margin: 4px 0; white-space: pre-wrap; font-size: 12px;">{{ comment.processing_info }}</pre>
                                </div>
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="text-gray-500 text-center py-8">暂无被屏蔽的评论</div>
            {% endif %}
        </div>
    </div>
    
    <!-- 被屏蔽的证据 -->
    <div class="bg-white rounded-lg shadow-md mb-8">
        <div class="px-6 py-4 border-b border-gray-200">
            <h2 class="text-xl font-semibold text-gray-800">被屏蔽的证据</h2>
        </div>
        <div class="p-6">
            {% if blocked_evidences %}
                <div class="space-y-4">
                    {% for evidence in blocked_evidences %}
                        <div class="border border-gray-200 rounded-lg p-4">
                            <div class="flex justify-between items-start mb-2">
                                <div>
                                    <span class="font-medium text-gray-800">案件 #{{ evidence.case_id }}</span>
                                    <span class="text-gray-500 text-sm ml-2">{{ evidence.created_at.strftime('%Y-%m-%d %H:%M') }}</span>
                                </div>
                                <span class="px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full">已屏蔽</span>
                            </div>
                            <div class="text-gray-700 mb-2">
                                <div><strong>原始内容：</strong>{{ evidence.content }}</div>
                                {% if evidence.processed_content and evidence.processed_content != evidence.content %}
                                    <div style="margin-top: 8px;"><strong>处理后内容：</strong>{{ evidence.processed_content }}</div>
                                {% endif %}
                            </div>
                            {% if evidence.violation_reason %}
                                <div class="text-sm text-red-600 bg-red-50 p-2 rounded">
                                    <strong>屏蔽原因：</strong>{{ evidence.violation_reason }}
                                </div>
                            {% endif %}
                            {% if evidence.processing_info %}
                                <div class="text-sm text-gray-600 bg-gray-50 p-2 rounded" style="margin-top: 8px;">
                                    <strong>处理详情：</strong>
                                    <pre style="margin: 4px 0; white-space: pre-wrap; font-size: 12px;">{{ evidence.processing_info }}</pre>
                                </div>
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="text-gray-500 text-center py-8">暂无被屏蔽的证据</div>
            {% endif %}
        </div>
    </div>
    
    <!-- 违规的调解协议 -->
    <div class="bg-white rounded-lg shadow-md">
        <div class="px-6 py-4 border-b border-gray-200">
            <h2 class="text-xl font-semibold text-gray-800">违规的调解协议</h2>
        </div>
        <div class="p-6">
            {% if blocked_agreements %}
                <div class="space-y-4">
                    {% for agreement in blocked_agreements %}
                        <div class="border border-gray-200 rounded-lg p-4">
                            <div class="flex justify-between items-start mb-2">
                                <div>
                                    <span class="font-medium text-gray-800">案件 #{{ agreement.case_id }}</span>
                                    <span class="text-gray-500 text-sm ml-2">{{ agreement.created_at.strftime('%Y-%m-%d %H:%M') }}</span>
                                </div>
                                <span class="px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded-full">违规内容</span>
                            </div>
                            <div class="text-gray-700 mb-2">
                                <div><strong>原始内容：</strong>{{ agreement.content[:200] }}{% if agreement.content|length > 200 %}...{% endif %}</div>
                                {% if agreement.processed_content and agreement.processed_content != agreement.content %}
                                    <div style="margin-top: 8px;"><strong>处理后内容：</strong>{{ agreement.processed_content[:200] }}{% if agreement.processed_content|length > 200 %}...{% endif %}</div>
                                {% endif %}
                            </div>
                            {% if agreement.violation_reason %}
                                <div class="text-sm text-orange-600 bg-orange-50 p-2 rounded">
                                    <strong>违规原因：</strong>{{ agreement.violation_reason }}
                                </div>
                            {% endif %}
                            {% if agreement.processing_info %}
                                <div class="text-sm text-gray-600 bg-gray-50 p-2 rounded" style="margin-top: 8px;">
                                    <strong>处理详情：</strong>
                                    <pre style="margin: 4px 0; white-space: pre-wrap; font-size: 12px;">{{ agreement.processing_info }}</pre>
                                </div>
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="text-gray-500 text-center py-8">暂无违规的调解协议</div>
            {% endif %}
        </div>
    </div>
</div>
    <p style="margin-top: 24px;">
      <a href="{{ url_for('admin_sensitive_words') }}">返回敏感词管理</a>
      | <a href="{{ url_for('index') }}">返回首页</a>
    </p>
  </div>
</body>
</html>